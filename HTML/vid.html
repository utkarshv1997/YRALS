<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>GreenScreen Removal</title>
    <script src="libraries/p5.js"></script>
    <script src="libraries/p5.dom.js"></script>
    <script src="libraries/p5.sound.js"></script>
    <script src="libraries/seriously.js"></script>
    <script src="libraries/effects/seriously.blur.js"></script>
    <script src="libraries/effects/seriously.chroma.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <style>
    	
    </style>

  </head>

  <body>
  	<div class="container-fluid">
  	<!-- <video src="upload/oneplusvideo.mp4" controls id="onevid" ></video> -->
	  	<div class="row">
		  	<div class="col-sm-4 col-xs-4 col-md-4">
		  		<div id="videodiv" style="float: left;width: 75%;"></div>
		  	</div>
		  	<div class="col-sm-8 col-md-8 col-xs-8"></div> 
		  		<div id="canvasdiv" style="float: left;">
		 	</div>
	 	</div>
	 	<!-- <div class="row">
	  	<div class="col-sm-4 col-xs-4 col-md-4">
	  		<div id="videodiv1" style="float: left; width: 25%;"></div>
	  	</div>
	  	<div class="col-sm-8 col-xs-8 col-md-8">
	  		<div id="canvasdiv1" style="float: left;"><img src="upload/phone.png" style="z-index: 10;position: absolute;top: 50%;left: 42%;"></div>
	 	</div> -->
	 	<!-- </div> -->
 	</div>
 	<!-- <div>
  		<div id="videodiv1" style="position: absolute; top: 90%;"></div>
  		<div id="canvasdiv1" style="position: absolute; top: 90%;left: 30%;">
  			<img src="upload/phone.png" style="z-index: 10;position: absolute;top: 57%;left: 27%;">
  		</div>
  	</div> -->
  </body>
  <script type="text/javascript">
  var slider;
    function setup() {
	        var x=document.createElement("VIDEO");
	        
	        x.setAttribute("width","100%");
	        x.setAttribute("height","100%"); 
	        x.setAttribute("controls","controls");
	        // x.setAttribute("autoplay","autoplay");
	        x.setAttribute("id","p5video");
	        x.setAttribute("src","upload/out.mp4");
	        // document.getElementById('videodiv').appendChild(x);

	        // document.body.appendChild(x);
       		var y=document.createElement("VIDEO");
	        
	        y.setAttribute("width","100%");
	        y.setAttribute("height","100%"); 
	        y.setAttribute("controls","controls");
	        // x.setAttribute("autoplay","autoplay");
	        y.setAttribute("id","onevid");
	        y.setAttribute("src","upload/oneplusvideo.mp4");
	       document.getElementById('videodiv').appendChild(y);

	       
        $("#p5video").on('loadedmetadata',function(){
        	// $("#p5canvas").css('width',$("#videodiv").width());
        	// $("#p5canvas").css('height',$("#videodiv").height());
        	// console.log($(window).width());
        	// console.log($(window).height());
        	// alert(screen.availwidth+" "+screen.availheight);
        	var a=this.videoWidth/((window.devicePixelRatio));
        	var b=this.videoHeight/((window.devicePixelRatio));
        	console.log(a+" , "+b+ " , "+window.devicePixelRatio);
	        canvas = createCanvas(a,b, WEBGL);
	        // canvas.height=b;
	        // canvas.width=a;
	        canvas.id('p5canvas');
	        canvas.style('z-index',10);
	        // var w=($("#p5video").width())*2;
	        // var h=($("#p5video").height())*2;
	        // var w1=w.toString()+'px';
	        // var h1=h.toString()+'px';
	        // canvas.style('width',w1);
	        // canvas.style('height',h1);
	        canvas.style('margin-left','5%');
	        canvas.style('border','2px solid black');
	        canvas.style('background-image','url("upload/final.jpg")');
	        canvas.style('background-repeat','no-repeat');
	        canvas.style('background-size','cover');
	        // canvas.style('width','100%');
	        // canvas.style('height','auto');
	        canvas.parent('canvasdiv');
	        console.log(canvas.width+" "+canvas.height);

	  //       var canvas = document.getElementById('p5canvas');
			// var ctx    = canvas.getContext('WEBGL');
			// var video  = document.getElementById('onevid');

			// video.addEventListener('play', function () {
			//     var $this = this; //cache
			//     (function loop() {
			//         if (!$this.paused && !$this.ended) {
			//             ctx.drawImage($this, 0, 0);
			//             setTimeout(loop, 1000 / 30); // drawing at 30fps
			//         }
			//     })();
			// }, 0);
	       
	        // var can=document.getElementById('p5canvas');
	        // var ctx=can.getContext('webgl') || can.getContext('experimental-webgl');
	        // slider=createSlider(0,1,0);
	        // slider.id('#slide');
	        // slider.style('display','none');
	        // var seriously1= new Seriously();
	        var seriously = new Seriously();

	        // var srcv = seriously1.source('#onevid');
	        // var targetv = seriously1.target('#p5canvas');
	        var srcv = seriously.source('#onevid');
	        var targetv = seriously.target('#p5canvas');

	        // var chroma = seriously.effect('chroma');
	        // chroma.source = src;
	        // target.source = chroma;
	        var blur=seriously1.effect('blur');
	        blur.amount = '#slide';
	        blur.source=srcv;
	        targetv.source=blur;
	        //var r = 200 / 255;
	        //var g = 200 / 255;
	        //var b = 200 / 255;
         //    var r = 88 / 255;
         //    var g = 154 / 255;
         //    var b = 76 / 255;
	        // chroma.screen = [r,g,b,1];
          // var r = 255 / 255;
          // var g = 215 / 255;
          // var b = 204 / 255;
          // chroma.screen = [r,g,b,1];
          	// seriously1.go();
	        seriously.go();
    });




	   //  $("#p5video1").on('loadedmetadata',function(){
    //     	//console.log(document.getElementById('p5video').videoWidth/4);
	   //      canvas = createCanvas($("#videodiv").width()*2.5,$("#videodiv").height()*3, WEBGL);
	   //      canvas.id('p5canvas1');
	   //      var w=($("#p5video1").width())*2;
	   //      var h=($("#p5video1").height())*2;
	   //      var w1=w.toString()+'px';
	   //      var h1=h.toString()+'px';
	   //      // canvas.style('width',w1);
	   //      // canvas.style('height',h1);
	   //      canvas.style('margin-left','5%');
	   //      canvas.style('border','2px dashed black');
	   //      // canvas.style('background-image','url("upload/phone.png")');
	   //      canvas.style('background-repeat','no-repeat');
	   //      canvas.style('background-size','cover');
	   //      canvas.parent('canvasdiv1');
	       
	   //      var can=document.getElementById('p5canvas1');
	   //      var ctx=can.getContext('webgl') || can.getContext('experimental-webgl');
	   //      var seriously = new Seriously();

	   //      var src = seriously.source('#p5video1');
	   //      var target = seriously.target('#p5canvas1');

	   //      var chroma = seriously.effect('chroma');
	   //      chroma.source = src;
	   //      target.source = chroma;
	   //      //var r = 200 / 255;
	   //      //var g = 200 / 255;
	   //      //var b = 200 / 255;
    //         var r = 83 / 255;
    //         var g = 171 / 255;
    //         var b = 211 / 255;
	   //      chroma.screen = [r,g,b,1];
    //       // var r = 255 / 255;
    //       // var g = 215 / 255;
    //       // var b = 204 / 255;
    //       // chroma.screen = [r,g,b,1];

	   //      seriously.go();
    // });

    }

  </script>
</html>



